TRUNCATE TABLE EDW_STAGING.ECDM_C_B_ADDR_OUT_SNAPSHOT;


INSERT INTO EDW_STAGING.ECDM_C_B_ADDR_OUT_SNAPSHOT (
    BATCH_NR,
    ADD_UPD_DEL_IND,
    ADDR_HASH_KEY,
    ADDR_LINE_1,
    ADDR_LINE_2,
    ADDR_LINE_3,
    ADDR_LINE_4,
    CITY,
    STATE,
    COUNTRY_CD,
    POSTAL_CD,
    POSTAL_EXT_CD,
    PROVINCE,
    VALIDATION_MSG,
    ZIP_10_13_NR,
    ZIP_CD,
    DMST_FRGN_CD,
    AD_VER_DT,
    HUB_STATE_IND,
    LST_UPDT_OPER_CD,
    SRC_LST_MOD_TS,
    ECDM_END_TS,
    ROW_PROCESS_DTM,
    AUDIT_ID,
    SOURCE_SYSTEM_ID,
    CURRENT_BATCH
)

SELECT
    0 AS BATCH_NR,
    'I' AS ADD_UPD_DEL_IND,
    SRC.SRC_SYS_AD_ID AS ADDR_HASH_KEY,
    SRC.AD_L1_TXT AS ADDR_LINE_1,
    SRC.AD_L2_TXT AS ADDR_LINE_2,
    SRC.AD_L3_TXT AS ADDR_LINE_3,
    SRC.AD_L4_TXT AS ADDR_LINE_4,
    SRC.CITY AS CITY,
    SRC.STATE AS STATE,
    SRC.CTRY_CD AS COUNTRY_CD,
    SRC.ZIP_1_5_NR AS POSTAL_CD,
    SRC.ZIP_6_9_NR AS POSTAL_EXT_CD,
    NULL AS PROVINCE,
    SRC.ADDR_VAL_CD AS VALIDATION_MSG,
    SRC.ZIP_10_13_NR AS ZIP_10_13_NR,
    SRC.FULL_POST_CD AS ZIP_CD,
    SRC.DMST_FRGN_CD AS DMST_FRGN_CD,
    SRC.ADDR_VER_DT AS AD_VER_DT,
    NULL AS HUB_STATE_IND,
    NULL AS LST_UPDT_OPER_CD,
    NULL AS SRC_LST_MOD_TS,
    NULL AS ECDM_END_TS,
    CURRENT_TIMESTAMP(6) AS ROW_PROCESS_DTM,
    0 AS AUDIT_ID,
    SRC.SRC_SYS_ID AS SOURCE_SYSTEM_ID,
    TRUE AS CURRENT_BATCH

FROM  PROD_STND_PRTY_VW_TERSUN.ST_AD_VW SRC;
